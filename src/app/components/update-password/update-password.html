<div class="form-container">
  <h2>Changer le mot de passe</h2>

  <form [formGroup]="updatePasswordForm" (ngSubmit)="onSubmit()">

    <!-- Nouveau mot de passe -->
    <div class="form-group">
      <label>Nouveau MDP</label>
      <div class="password-wrapper">
        <input [type]="showNewPassword ? 'text' : 'password'" formControlName="newPassword" />
        <span class="toggle-eye" (click)="showNewPassword = !showNewPassword">
          {{ showNewPassword ? 'ğŸ‘ï¸â€ğŸ—¨ï¸' : 'ğŸ‘ï¸' }}
        </span>
      </div>
    </div>

    <div class="password-criteria">
      <small [class.valid]="passwordLength" [class.invalid]="!passwordLength">Minimum 8 caractÃ¨res</small>
      <small [class.valid]="passwordHasUpper" [class.invalid]="!passwordHasUpper">Contient une majuscule</small>
      <small [class.valid]="passwordHasLower" [class.invalid]="!passwordHasLower">Contient une minuscule</small>
      <small [class.valid]="passwordHasSpecial" [class.invalid]="!passwordHasSpecial">Contient un caractÃ¨re spÃ©cial (!@#$%^&.*)</small>
    </div>

    <div *ngIf="submitted && f['newPassword'].errors" class="error">
      <small *ngIf="f['newPassword'].errors['required']">Le mot de passe est requis.</small>
      <small *ngIf="f['newPassword'].errors['weakPassword']">Mot de passe trop faible.</small>
    </div>

    <!-- Confirmation -->
    <div class="form-group">
      <label>Confirmer</label>
      <div class="password-wrapper">
        <input [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" />
        <span class="toggle-eye" (click)="showConfirmPassword = !showConfirmPassword">
          {{ showConfirmPassword ? 'ğŸ‘ï¸â€ğŸ—¨ï¸' : 'ğŸ‘ï¸' }}
        </span>
      </div>
    </div>

    <div *ngIf="submitted && f['confirmPassword'].errors" class="error">
      <small *ngIf="f['confirmPassword'].errors['required']">Confirmation requise.</small>
    </div>

    <div *ngIf="submitted && updatePasswordForm.errors?.['mismatch']" class="error">
      <small>Les mots de passe ne correspondent pas.</small>
    </div>

    <button type="submit">Mettre Ã  jour</button>
  </form>
</div>

<!-- Messages -->
<div *ngIf="submitted" class="submission-message">
  <div *ngIf="success === true" class="success-message">
    ğŸ‰ Mot de passe mis Ã  jour !
  </div>
  <div *ngIf="success === false" class="error-message">
    âŒ Erreur : {{ error }}
  </div>
</div>
